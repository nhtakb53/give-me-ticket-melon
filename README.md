# Give Me Ticket Melon 🎫

멜론 티켓 예매를 위한 자동화 도구입니다. 정확한 시간에 티켓 예매를 시도하여 성공률을 높이는 스크립트입니다.

## 📋 프로젝트 개요

이 프로젝트는 멜론 티켓 사이트의 티켓 예매 과정을 자동화하는 도구입니다. 서버 시간과의 동기화를 통해 정확한 시간에 예매 요청을 보내어 예매 성공률을 극대화합니다.

## ⚠️ 주의사항

- 이 도구는 교육 및 연구 목적으로만 사용되어야 합니다
- 실제 티켓 예매 시에는 멜론 티켓의 이용약관을 준수해야 합니다
- 부정한 방법으로 예매하는 것은 금지되어 있으며, 계정 제재를 받을 수 있습니다
- 사용자는 본인의 책임 하에 사용해야 합니다

## 🚀 주요 기능

### 1. 서버 시간 동기화
- 멜론 서버와의 시간 오프셋을 측정하여 정확한 동기화
- 네트워크 지연 시간(RTT)을 고려한 보정
- 실시간 재보정을 통한 정확도 향상

### 2. 정밀한 타이밍 제어
- 설정된 시간에 정확히 예매 요청 실행
- 여러 단계의 대기 및 폴링 메커니즘
- 메인 스레드 블로킹 최소화

### 3. 설정 가능한 매개변수
- 상품 ID, 회차 번호, 예매 시간 등 커스터마이징 가능
- 오프셋 샘플 수, 재보정 간격 등 세부 조정 가능

## 📁 프로젝트 구조

```
give-me-ticket-melon/
├── melon.js                 # 메인 자동화 스크립트
├── assets/                  # 멜론 티켓 사이트 리소스
│   ├── css/                 # 스타일시트
│   ├── js/                  # JavaScript 라이브러리
│   ├── images/              # 이미지 리소스
│   └── index.htm            # 메인 HTML 페이지
└── README.md               # 프로젝트 문서
```

## ⚙️ 설정 방법

### 1. 기본 설정 수정

`melon.js` 파일의 `CONFIG` 객체를 수정하여 예매 정보를 설정합니다:

```javascript
const CONFIG = {
  prodId: "212081",          // 상품 ID
  scheduleNo: 100001,        // 회차 번호
  fireTime: "20:47:45",      // 예매 시작 시간 (HH:mm:ss)
  offsetSamples: 30,         // 초기 오프셋 샘플 수
  offsetGapMs: 60,           // 샘플 간격 (ms)
  recalSamples: 10,          // 재보정 샘플 수
  recalGapMs: 40,            // 재보정 간격 (ms)
  sellTypeCode: "ST0002",    // ST0001: 일반예매, ST0002: 선예매
  reservationType: "ST0002", // 예매 타입
  netfunnelName: "preReservationOneStopZAM" // 넷퍼넬 설정
};
```

### 2. 필요한 정보 확인

예매하기 전에 다음 정보를 확인해야 합니다:

- **상품 ID (prodId)**: 예매하려는 공연의 고유 ID
- **회차 번호 (scheduleNo)**: 예매하려는 회차의 번호
- **예매 시간 (fireTime)**: 티켓 오픈 시간
- **예매 타입**: 일반예매 또는 선예매

## 🔧 사용 방법

### 1. 브라우저에서 실행

1. 멜론 티켓 사이트에 로그인
2. 예매하려는 공연 페이지로 이동
3. 브라우저 개발자 도구 열기 (F12)
4. Console 탭에서 `melon.js` 파일의 내용을 복사하여 실행

### 2. 스크립트 실행

스크립트가 실행되면 다음과 같은 과정을 거칩니다:

1. **초기 오프셋 측정**: 서버와의 시간 차이를 30회 측정하여 중앙값 계산
2. **목표 시간 계산**: 설정된 예매 시간이 오늘인지 내일인지 판단
3. **대기 단계**: 예매 시간 5초 전까지 대기
4. **재보정**: 예매 시간 5초 전에 다시 10회 측정하여 정확도 향상
5. **정밀 대기**: 예매 시간 2초 전부터 정밀한 폴링 시작
6. **최종 실행**: 설정된 시간에 정확히 예매 요청 실행

## 📊 실행 결과

스크립트 실행 후 콘솔에 다음과 같은 정보가 출력됩니다:

```
🔥 파이어!
   로컬시각 : 2025-10-15T20:47:45.123Z
   서버기준 : 2025-10-15T20:47:45.000Z
```

## 🛠️ 기술적 특징

### 시간 동기화 알고리즘
- HTTP 헤더의 `Date` 필드를 이용한 서버 시간 측정
- 네트워크 지연 시간(RTT)을 고려한 보정
- 95% RTT를 이용한 보수적 마진 설정

### 성능 최적화
- `requestAnimationFrame`을 이용한 부드러운 폴링
- 메인 스레드 블로킹 최소화
- 짧은 스핀 루프를 통한 정밀한 타이밍 제어

### 오류 처리
- 네트워크 오류에 대한 재시도 메커니즘
- 시간 동기화 실패 시 대체 로직
- 예외 상황에 대한 안전장치

## 🔍 문제 해결

### 자주 발생하는 문제

1. **시간 동기화 실패**
   - 네트워크 연결 상태 확인
   - 방화벽 설정 확인
   - 브라우저 캐시 삭제

2. **예매 요청 실패**
   - 로그인 상태 확인
   - 상품 ID 및 회차 번호 확인
   - 예매 시간 설정 확인

3. **스크립트 실행 오류**
   - 브라우저 콘솔 오류 메시지 확인
   - JavaScript 활성화 상태 확인
   - 필요한 라이브러리 로드 확인

## 📝 라이선스

이 프로젝트는 교육 및 연구 목적으로만 사용되어야 합니다. 상업적 사용이나 부정한 목적으로의 사용은 금지됩니다.

## 🤝 기여하기

버그 리포트나 기능 개선 제안은 언제든 환영합니다. 다만, 이 도구의 사용으로 인한 모든 책임은 사용자에게 있습니다.

## ⚖️ 법적 고지

- 이 도구는 멜론 티켓의 공식 도구가 아닙니다
- 사용자는 멜론 티켓의 이용약관을 준수해야 합니다
- 부정한 예매 시도로 인한 계정 제재는 사용자의 책임입니다
- 개발자는 이 도구 사용으로 인한 모든 결과에 대해 책임지지 않습니다

---

**면책 조항**: 이 도구는 교육 목적으로만 제공되며, 실제 티켓 예매 시에는 멜론 티켓의 정책과 이용약관을 반드시 준수해야 합니다.
